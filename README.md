# WishList App

Простое и удобное приложение для создания списков желаний. Позволяет пользователям создавать списки подарков, которыми они хотели бы поделиться с друзьями и близкими.

## О проекте

WishList - это веб-приложение с будущими мобильными клиентами (iOS), которое помогает пользователям:
- Создавать списки желаемых подарков
- Делиться списками с друзьями
- Отмечать подарки как забронированные
- Управлять своими пожеланиями

## Технологии

### Backend
- **.NET 9.0** - основной фреймворк
- **Entity Framework Core** - ORM для работы с базой данных
- **MediatR** - реализация паттерна CQRS
- **MySQL** - система управления базами данных
- **Docker** - контейнеризация приложения
- **Minimal API** - современный подход к созданию API

### Frontend (в разработке)
- **Web Application** - веб-клиент
- **iOS Application** - мобильное приложение для iOS

## Архитектура

Проект построен по принципам Clean Architecture и использует:
- **CQRS** через MediatR
- **Repository Pattern** через Entity Framework
- **Dependency Injection**
- **Minimal APIs**

## Установка и запуск

### Предварительные требования
- Docker
- Docker Compose
- .NET 9.0 SDK (для разработки)

### Запуск в Docker

1. **Клонируйте репозиторий**
```bash
git clone <repository-url>
cd WishList
```

2. **Запустите приложение**
```bash
docker-compose up --build
```

3. **Приложение будет доступно по адресу**
```
http://localhost:8080
```

### Локальная разработка

1. **Восстановите зависимости**
```bash
dotnet restore
```

2. **Запустите базу данных**
```bash
docker-compose up mysql -d
```

3. **Запустите приложение**
```bash
dotnet run
```

## API Endpoints

### Пользователи

#### Создание пользователя
- **POST** `/wishlist/usercreate`
- **Тело запроса:**
```json
{
  "userName": "Имя пользователя",
  "password": "Пароль",
  "birthday": "1990-01-01",
  "emaail": "user@example.com"
}
```
- **Ответ:**
```json
{
  "id": 1,
  "message": "Ваш Id {хэш-пароля}"
}
```

### Вишлисты

#### Создание вишлиста
- **POST** `/wishlist/listcreate`
- **Тело запроса:**
```json
{
  "gift": "Название подарка",
  "url": "https://example.com/link-to-gift",
  "price": 1500,
  "userId": 1
}
```
- **Ответ:**
```json
{
  "id": 1,
  "message": "Id Подарка",
  "userId": 1,
  "message2": "ID Пользователя"
}
```

#### Просмотр вишлиста пользователя
- **GET** `/wishlist/chek/{id}`
- **Параметры:**
  - `id` - ID пользователя
- **Ответ:** Список вишлистов пользователя с деталями подарков

## База данных

### Таблицы

#### Users
- `Id` (PK) - идентификатор пользователя
- `UserName` (string, 45) - имя пользователя
- `UserPassword` (string, 255) - хэш пароля
- `Birthday` (DateOnly) - дата рождения
- `Email` (string) - электронная почта (уникальный)
- `WishLists` (Navigation) - список вишлистов пользователя

#### WishList
- `WishListId` (PK) - идентификатор вишлиста
- `UserId` (FK) - ссылка на пользователя
- `Gift` (string, 255) - название подарка
- `Url` (string, 255) - ссылка на подарок
- `Price` (int) - цена
- `Booked` (sbyte) - флаг бронирования (0/1), по умолчанию 0
- `CreatedAt` (DateTime) - дата создания, по умолчанию CURRENT_TIMESTAMP

### Связи
- Пользователь (User) имеет множество вишлистов (WishList)
- Вишлист принадлежит одному пользователю

### Миграции
```bash
dotnet ef migrations add InitialCreate
dotnet ef database update
```

## Структура проекта

```
WishList/
├── DbModels/           # Модели базы данных
│   ├── SysContext.cs   # Контекст базы данных
│   ├── User.cs         # Модель пользователя
│   └── WishList.cs     # Модель вишлиста
├── CreateUser/         # Функциональность создания пользователя
│   ├── CreateUserEndpoint.cs
│   ├── CreateUserHandler.cs
│   ├── CreateUserRequest.cs
│   └── CreateUserResponse.cs
├── CreateList/         # Функциональность создания вишлиста
│   ├── CreateListEndpoint.cs
│   ├── CreateListHandler.cs
│   ├── CreateListRequest.cs
│   └── CreateListResponse.cs
├── ChekList/           # Функциональность просмотра вишлиста
│   ├── ChekListEndpoint.cs
│   ├── ChekListHandler.cs
│   └── ChekListResponse.cs
├── Program.cs          # Точка входа приложения
└── docker-compose.yml  # Docker конфигурация
```

## Особенности реализации

### Безопасность
- Пароли хэшируются с помощью `GetHashCode()` (требуется улучшение для production)
- Уникальные ограничения на email

### Обработка ошибок
- Использование CancellationToken для отмены операций
- Retry логика для подключения к базе данных

### Производительность
- Eager loading вишлистов при запросе пользователя
- Асинхронные операции базы данных

## Планы по развитию

### Ближайшие задачи
- [ ] Регистрация и аутентификация пользователей
- [ ] CRUD операции для вишлистов
- [ ] Система бронирования подарков
- [ ] Веб-интерфейс
- [ ] Улучшение безопасности (более надежное хэширование паролей)

### Будущие возможности
- [ ] Мобильное приложение для iOS
- [ ] Уведомления о бронировании
- [ ] Система рекомендаций подарков
- [ ] Интеграция с социальными сетями
- [ ] Система рейтингов и отзывов
- [ ] Поддержка изображений для подарков
- [ ] Категории подарков
- [ ] Поиск и фильтрация вишлистов

## Отладка

### Просмотр логов
```bash
docker logs wishlist-app
docker logs wishlist-mysql
```

### Проверка здоровья базы данных
```bash
docker-compose ps
```

### Миграции базы данных
```bash
# Создание миграции
dotnet ef migrations add MigrationName

# Применение миграций
dotnet ef database update
```

## Команда
Ufa-Dynamics, Данияр Камаев

Разрабатывается с любовью для упрощения процесса выбора и дарения подарков.

---

**Примечание:** Этот проект находится в активной разработке. API и функционал могут изменяться.

**Важное замечание по безопасности:** В текущей реализации используется `GetHashCode()` для хэширования паролей, что небезопасно для production. Рекомендуется заменить на более надежные методы хэширования (BCrypt, PBKDF2 и т.д.) перед развертыванием в production.
